### 硬件假设（请务必在硬件设计时参考）

1. **MCU主频**：系统时钟必须配置为 **24MHz**（STC8H 内部 RC 振荡器精度很高，推荐使用）。
2. **控制引脚**：默认定义为 **P1.2**。
3. **LED 灯带**：数据线串联，第一颗灯的 DI 接 MCU，后续 DO 接下一颗 DI。





### 关键点总结 (开发前必读)

1. **RAM 占用分析**：
   - `PixelBuffer`: 198 字节
   - `TargetBuffer`: 198 字节
   - `FadeCounters`: 132 字节 (66 * 2)
   - 总计静态占用：**528 字节**。
   - STC8H1K08 的 SRAM 是 1KB (256 idata + 768 xdata)。
   - **重要**：请务必在 Keil 的 Target 设置中，将 **Memory Model** 设置为 **"Large: variables in XDATA"**，否则默认的 Small 模式 (128字节) 肯定会爆栈报错。
2. **关于 `SetLed` 接口**：
   - 我完全按照你的要求定义了形参。
   - `brightness` 参数通过修改 `Target` 颜色值在**调用瞬间**生效。如果你对一个正在渐变的 LED 再次调用 SetLed，它会从当前颜色开始，渐变到新的（经过亮度计算后的）目标颜色，这是最自然的视觉效果。
3. **时序调试**：
   - 如果发现灯颜色乱闪，通常是 `ws2811_hal.c` 中的 `NOP` 延时不对。
   - 请用示波器测量 `LED_PIN` 的波形。‘0’码的高电平应在 220ns-380ns 之间，‘1’码的高电平应在 580ns-1000ns 之间。

这段代码可以直接复制到你的工程中作为基础。有任何具体的灯效逻辑需求（如呼吸、彩虹扫描），可以在 `Demo_Effect_Run` 中扩展。